;TRAINの骨格
@TRAIN_MAIN
;変数初期化
CALL TRAIN_VAR_RESET
;TRAIN開始前処理
CALL EVENTTRAIN0

;メインループ、プレイヤーの動きは基本はここ
CALL TRAIN_MAIN_LOOP

;TRAIN終了処理
CALL EVENTEND0



;TRAINでの動き
@TRAIN_MAIN_LOOP
FLAG:1 = 0
;ステータス표시
CALL SHOW_STATUS
;コマンド표시
CALL SHOW_USERCOM
SIF NEXTCOM == -1
	INPUT
;コマンド処理
CALL USERCOM

;コマンドが呼ばれていない、実行不能
SIF RESULT
	RESTART
CALL SOURCE_CHECK
CALL EVENTCOMEND0
IF FLAG:1
	RETURN 0
ELSE
	RESTART
ENDIF



@TRAIN_VAR_RESET
#LOCALSIZE 1

VARSET PREVCOM, 0
VARSET NEXTCOM, -1
VARSET SELECTCOM, 0
VARSET TFLAG, 0
VARSET TSTR, ""
VARSET UP, 0
VARSET DOWN, 0
VARSET LOSEBASE, 0

FOR LOCAL, 0,CHARANUM
	VARSET GOTJUEL:LOCAL:0, 0
	VARSET PALAM:LOCAL:0, 0
	VARSET TEQUIP:LOCAL:0, 0
	VARSET EX:LOCAL:0, 0
	VARSET SOURCE:LOCAL:0, 0
	VARSET TCVAR:LOCAL:0, 0
	VARSET CUP:LOCAL:0, 0
	VARSET CDOWN:LOCAL:0, 0
	VARSET DOWNBASE:LOCAL:0, 0
NEXT


FOR LOCAL, 0,CHARANUM
	VARSET TCVAR:LOCAL:0, 0
NEXT
