
@IRAI_DUEL_INTRO_396
#DIM DYNAMIC カウンタ
;듀얼前に「詰め플래그」に1を설定し、最初の5ドローをスキップ
;ターン跨いで処理したいので、듀얼が始まったら詰め플래그をリセット
詰め플래그 = 0

;詰め플래그でスキップしてしまった初期化
CALL CARD_LOADUP

;必要に応じて、ターンプレイヤーを변경(ここで자신にすると、상대의 ターンになる)
;ターンプレイヤー = 자신

;1以上の値を入れると、1한번만 ドローがスキップされる
SETVAR @"자신_ドロースキップ", 1
SETVAR @"상대_ドロースキップ", 1

;SETVAR @"자신_バトルスキップ", 1
;SETVAR @"상대_メインスキップ", 1

;필드의 情報を설정
SETVAR @"자신_魔_所有:2", 1;자신의 カード
SETVAR @"자신_魔_表:2", 1;表
SETVAR @"자신_마함:2",79555;호루스타인ミルクファーム

SETVAR @"상대_MZ_所有:2", 2;상대의 カード
SETVAR @"상대_MZ_表:2", 1;表
SETVAR @"상대_필드:2",41955;トライヒハート

;자신의 패
SETVAR @"자신_손패:0", 70011;増援

;자신의 덱
SETVAR @"자신_덱:0", 79558;지유登録
SETVAR @"자신_덱:1", 2123;オオヒメの미캉코
SETVAR @"자신_덱:2", 2124;アラヒメの미캉코
SETVAR @"자신_덱:3", 99554;ドリップ
SETVAR @"자신_덱:4", 79557;애유
SETVAR @"자신_덱:5", 99554;ドリップ

;자신의 묘지
;SETVAR @"자신_묘지:0", 23063;混沌の使者(エンドフェイズ時、빛속성と어둠속성을 제외하고 패에 加える)
;SETVAR @"자신_묘지:1", 23962;어둠・サキュバスナイト
;SETVAR @"자신_묘지:2", 11607;光・クイーズナイト


;상대의 손패
SETVAR @"상대_손패:0", 70090;カウントダウン
SETVAR @"상대_손패:1", 70090;カウントダウン
SETVAR @"상대_손패:2", 70090;カウントダウン
SETVAR @"상대_손패:3", 71006;突進

;상대의 덱：引いても使えない札
SETVAR @"상대_덱:0", 41811;의식ガストクラーケ
SETVAR @"상대_덱:1", 41811
SETVAR @"상대_덱:2", 41811
SETVAR @"상대_덱:3", 41811

ライフ_상대 = 6250
ターン数 = 0;이 턴 は戦闘をさせたくないので、1ターン目扱いにする

@IRAI_DECK_396(듀얼리스트)
#DIMS DYNAMIC 듀얼리스트

SIF 듀얼리스트 == "자신"
	;더미덱
	RETURN 20396
SIF 듀얼리스트 == "상대"
	;더미덱
	RETURN 20396
RETURN 0

;더미덱
@DUELDECK_20396(듀얼리스트)
#DIMS DYNAMIC 듀얼리스트

SETVAR @"%듀얼리스트%_덱:POOL_COUNT(1)", 24270
;SETVAR @"%듀얼리스트%_덱:POOL_COUNT(0)", 24270

;융합
SETVAR @"%듀얼리스트%_EX덱:POOL_COUNT(1)", 41000;룡BMG
SETVAR @"%듀얼리스트%_EX덱:POOL_COUNT(0)", 2055;ハスキー
;싱크로
SETVAR @"%듀얼리스트%_EX덱:POOL_COUNT(0)", 11870;신子イヴ
SETVAR @"%듀얼리스트%_EX덱:POOL_COUNT(0)", 41390;로즈마リー
;엑시즈
SETVAR @"%듀얼리스트%_EX덱:POOL_COUNT(0)", 41816;翠기사カーム
SETVAR @"%듀얼리스트%_EX덱:POOL_COUNT(0)", 42103;엑소시스터ジブリーヌ
;링크
SETVAR @"%듀얼리스트%_EX덱:POOL_COUNT(0)", 2002;카멜리아
SETVAR @"%듀얼리스트%_EX덱:POOL_COUNT(0)", 1631;アポロウーサ


;승리条件の설정、ここで詰めデュエルの승리条件を설치할 수 있다。
@IRAI_DUEL_CONDVIC_396
#DIMS DYNAMIC 듀얼리스트
#DIMS DYNAMIC 対面者
#DIM DYNAMIC 듀얼進捗
#DIM DYNAMIC 現在値

VARSET RESULT

듀얼리스트 = 자신
対面者 = 상대

現在値 = GETVAR(@"%듀얼리스트%_薬Ｃ")
SIF INRANGE(現在値,-1,1)
	現在値 = 2

듀얼進捗 = 1
;상대의 LPを0にしたらクリア

SIF ライフ_상대 == 0
	RETURN 1
	
;패에 애유あり
듀얼進捗 ++;2
CALL FULLRESET
효과範囲손패 = 1
효과条件ID = 79557
효과条件CNT = 1
CALL CARD_CHECK_ADV("자신")
SIF RESULT == 1 && 現在値 == 듀얼進捗
	RETURN 듀얼進捗 + 1

;패에 지유あり
듀얼進捗 ++
CALL FULLRESET
효과範囲손패 = 1
효과条件ID = 79558
효과条件CNT = 1
CALL CARD_CHECK_ADV("자신")
SIF RESULT == 1 && 現在値 == 듀얼進捗
	RETURN 듀얼進捗 + 1

;패에 ドリップあり
듀얼進捗 ++
CALL FULLRESET
효과範囲손패 = 1
효과条件ID = 99554
효과条件CNT = 1
CALL CARD_CHECK_ADV("자신")
SIF RESULT == 1 && 現在値 == 듀얼進捗
	RETURN 듀얼進捗 + 1

;ドリップ使用済み
듀얼進捗 ++
SIF 발동済_1(듀얼리스트,99554) && 現在値 == 듀얼進捗
	RETURN 듀얼進捗 + 1

;メインフェイズ(ターンプレイヤーが상대)
듀얼進捗 ++
SIF ターンプレイヤー == 対面者 && 現在値 == 듀얼進捗
	RETURN 듀얼進捗 + 1

;バトルフェイズ
듀얼進捗 ++
SIF バトルフェイズ == 1 && 現在値 == 듀얼進捗
	RETURN 듀얼進捗 + 1

;애유の打点が3250から3000に(파괴되는 とリセットなので)
듀얼進捗 ++
SIF GETVAR(@"%듀얼리스트%_MZ_攻:2") == 3000 && 現在値 == 듀얼進捗
	RETURN 듀얼進捗 + 1

;자신ターン：メインフェイズ
듀얼進捗 ++
SIF ターンプレイヤー == 듀얼리스트 && 現在値 == 듀얼進捗
	RETURN 듀얼進捗 + 1

;자신ターン：バトルフェイズ
듀얼進捗 ++
SIF バトルフェイズ == 1 && 現在値 == 듀얼進捗
	RETURN 듀얼進捗 + 1

;자신ターン：애유발동済み
듀얼進捗 ++
SIF 발동済_1(듀얼리스트,179557) && 現在値 == 듀얼進捗
	RETURN 듀얼進捗 + 1

;자신ターン：ドリップ適用済み
듀얼進捗 ++
SIF GETVAR(@"%듀얼리스트%_MZ_発情:2") == 100 && 現在値 == 듀얼進捗
	RETURN 듀얼進捗 + 1

RETURN 現在値

;メッセージの설정
@IRAI_DUEL_MESSAGE_396(存在確認)
#DIM DYNAMIC 存在確認
#DIMS DYNAMIC 듀얼리스트
VARSET RESULT

듀얼리스트 = 자신

IF 存在確認 == 1
	RETURN 1
ENDIF

;リアクション
CALL IRAI_DUEL_CONDVIC_396

SELECTCASE RESULT

CASE 1
	;デュエルクリア！
	PRINTFORML 수고하셨습니다!
	PRINTFORML "승리 조건 달성"을 누르면 종료됩니다!

;1ターン目
CASE 2
	;初期表시
	PRINTFORML 상대의 LP를 0으로 만드는 것이 승리 조건이다. 단, 이번 상대는 트라이히하트… L 몬스터 이외를 수비 표시로 만드는 강력한 몬스터다.
	PRINTFORML 이번에는 그를 쓰러뜨릴 수 있도록 판을 정돈해 봅시다.
	PRINTFORML 우선은 "밀크 팜"으로 "【애유】 등록"을 패에 추가하자.
CASE 3
	;패에 애유あり
	PRINTFORML 【애유】 등록은 "패의 애유를 특수 소환한다" 대신에, "호루스타인 일반 마법 카드를 패에 추가"할 수도 있다.
	PRINTFORML 이번에는 【지유】등록을 패에 추가하자.
CASE 4
	;패에 지유あり
	PRINTFORML 【지유】등록도 발동하여, 덱에서 "착유(드립)"를 패에 추가하자.
CASE 5
	;패에 ドリップあり
	PRINTFORML 드립의 효과로 【애유】를 특수 소환하자.
	PRINTFORML 이 효과로 특수 소환된 몬스터는 "드립 상태"가 된다.
	PRINTFORML "드립 상태"가 된 몬스터는 스탠바이 페이즈에 자동으로 착유되어, 공격력/수비력이 250 포인트 상승한다!
CASE 6
	;ドリップ使用済み
	PRINTFORML 턴을 종료합시다.

;2ターン目
CASE 7
	;メインフェイズ(ターンプレイヤー가상대)
	PRINTFORML 돌진으로 트라이히하트의 공격력이 올라 버렸지만, 문제없으니 이대로 전개를 지켜봅시다.
	PRINTFORML 
	PRINTFORML 수비 표시의 호루스타인 몬스터가 드립 상태일 때, 호루스타인 이외의 카드가 발동하면 조금 착유된다.
	PRINTFORML 상대의 전개를 바라보며, 천천히 암소의 젖이 드립되기를 기다리자.
CASE 8
	;バトルフェイズ
	PRINTFORML 【애유】의 효과를 발동하여 젖을 짜자. 이걸로 파괴되어도 소생할 수 있게 된다.
	PRINTFORML 드립으로 추가 효과가 부여되어 있지만… 지금은 건드려도, 건드리지 않아도, 어느 쪽이든 괜찮다.
	PRINTFORML 문제없으면 턴을 진행합시다.
CASE 9
	;애유효과발동
	PRINTFORML 이대로는 트라이히하트를 돌파할 수 없으니… 묘지의 드립의 효과를 발동하자.
	PRINTFORML 드립을 제외하고, 자신 필드의 암소 몬스터를 "드립 상태"로 만들 수 있다.
	PRINTFORML 다시 【애유】를 드립 상태로 만들고, 턴을 종료하자.
CASE 10
	;자신ターン：メインフェイズ
	PRINTFORML 드립의 효과로 트라이히하트의 공격력을 넘어섰을까?
	PRINTFORML 현재 어느 정도 착유했는지 궁금하다면, 메인 페이즈에 【애유】의 효과를 발동해보자.
	PRINTFORML 주의점으로서, 드립으로 부여된 "부여 효과"는 아직 사용하면 안 된다.
	PRINTFORML 
	PRINTFORML 문제가 없다면 배틀 페이즈에 들어가자!
CASE 11
	;자신ターン：バトルフェイズ
	PRINTFORML 우선은 【애유】의 효과로 젖을 짜서, 수비 표시인 채로 공격할 수 있도록 하자.
CASE 12
	;자신ターン：애유발동済み
	PRINTFORML 이번에는 "암소 발정 제어 장치 시작"이 걸려있지 않다는 것을 눈치챘을까?
	PRINTFORML 【애유】는 발정했지만, 자신의 효과로 부여되는 발정은, 공격 중단 확률이 75퍼센트 정도로 확실하게 공격할 수는 없다…
	PRINTFORML 그럴 때는 "드립 상태"일 때 발동할 수 있는 "부여 효과"로 발정을 부여하자.
	PRINTFORML 암소를 "리프레시"해주므로, 발정 상태에서도 공격이 중단되지 않게 된다!
	PRINTFORML 
	PRINTFORML 주의점으로서, 발정 상태는 덮어쓰기이므로, 발동하는 순서에 주의하자! [먼저 드립→암소 효과의 순서라면 ×]
CASE 13
	;자신ターン：ドリップ適用済み
	PRINTFORML 【애유】의 공격은 관통한다!
	PRINTFORML 이대로 피니시 블로우를 날립시다!
CASEELSE
	PRINTFORML 아, 실패했나? 싶으면 "항복하기"에서 다시 시작할 수 있어요. …뭐, 부담 없이.
	RESULT = -1
ENDSELECT

;카운터でメッセージの進捗を관리
SIF RESULT != -1
	SETVAR @"자신_薬Ｃ",RESULT
