@CARDNAME_52355,参照先
;ココで指定カードの名前、略称を返す予定
#DIMS DYNAMIC 参照先

VARSET RESULT
VARSET RESULTS

SELECTCASE 参照先
	CASE "名前"
		RESULTS = アームド・ドラゴン・カタパルトキャノン
	CASE "略称"
		RESULTS = アームド・D・CC
	CASE "カテゴリ"
		RESULTS:0 = アームド・ドラゴン
ENDSELECT


@CARD_52355(参照先)

#DIMS DYNAMIC 参照先
VARSET RESULT
VARSET RESULTS

SELECTCASE 参照先
	CASE "種類"
		RETURN 融合
	CASE "属性"
		RETURN 光属性
	CASE "種族"
		RETURN 機械族
	CASE "レベル"
		RETURN 10
	CASE "攻撃力"
		RETURN 4500
	CASE "守備力"
		RETURN 4000
ENDSELECT

RETURN 0

@CARD_EXPLANATION_52355(種類)
#DIM DYNAMIC 種類

PRINTL 「VWXYZ－ドラゴン・カタパルトキャノン」＋ レベル７以上の「アームド・ドラゴン」モンスター
PRINTL このカードは自分のフィールド・墓地の上記のカードを除外してＥＸデッキから特殊召喚することもできる。
CALLFORM CARD_ABLE(10,戦場起動)
PRINTL ①：このカードがモンスターゾーンに存在する限り、
PRINTL 除外されている自分・相手のカードと同名カードの相手のカードの効果は無効化される。
CALLFORM CARD_ABLE(0,攻撃時誘発)
PRINTL ②：デッキ・EXデッキからカード１枚を除外して発動できる。
PRINTL 相手のフィールド・墓地のカードを全て除外する。


@CARDSUMMON_52355(決闘者,召喚カード,EX参照)
#DIMS DYNAMIC 決闘者
#DIM DYNAMIC 召喚カード
#DIM DYNAMIC EX参照
;素材条件
素材条件名前:0 = ＶＷ－タイガー・カタパルト
素材条件名前:1 = ＸＹＺ－ハイパー・ドラゴン・キャノン

RETURN 0

@CARDCAN_52355(決闘者,種類,ゾーン,場所)
#DIMS DYNAMIC 決闘者
#DIMS DYNAMIC ゾーン
#DIMS DYNAMIC 対面者
#DIM DYNAMIC 種類
#DIM DYNAMIC 場所
#DIM DYNAMIC カウンタ
#DIM DYNAMIC 条件達成
#DIM DYNAMIC 使用済み
#DIM DYNAMIC 効果使用不可,3

CALL 対面者判定(決闘者)
対面者 = %RESULTS%

CALL CARD_NEGATE(決闘者,種類,ゾーン,場所,52355)
SIF RESULT == 1
	RETURN 0

IF 種類 == EXデッキ起動
	SIF メインフェイズ != 1
		RETURN 0
	SIF ターンプレイヤー != 決闘者
		RETURN 0
	SIF GETVAR(@"%決闘者%_除外NG置換") >= 1
		RETURN 0
	CALL CARD_EX_CHECK(決闘者,52355)
	SIF RESULT == 1
		RETURN 0
	CALL FULLRESET
	効果範囲戦場 = 1
	効果範囲魔罠 = 1
	効果範囲墓地 = 1
	効果条件名前 = VWXYZ－ドラゴン・カタパルトキャノン
	CALL CARD_CHECK_ADV(決闘者,種類,ゾーン,場所)
	SIF RESULT != 1
		RETURN 0
	CALL FULLRESET
	効果範囲戦場 = 1
	効果範囲魔罠 = 1
	効果範囲墓地 = 1
	効果条件カテゴリ = アームド・ドラゴン
	CALLFORM 効果条件レベル_ADV(7, "以上")
	CALL CARD_CHECK_ADV(決闘者,種類,ゾーン,場所)
	SIF RESULT != 1
		RETURN 0
	RETURN 1
ELSEIF 種類 == 攻撃時誘発
	SIF ゾーン != "戦場"
		RETURN 0
	SIF 戦闘場所(決闘者) != 場所
		RETURN 0
	SIF 戦闘場所(決闘者,1) == 5
		RETURN 0
	RETURN 1
ELSEIF 種類 == 戦場起動 || 種類 == フリー誘発
	IF ターンプレイヤー == 決闘者
		SIF ゾーン != "戦場"
			RETURN 0
		SIF メインフェイズ != 1
			RETURN 0
		SIF ターンプレイヤー != 決闘者
			RETURN 0
		SIF 種類 == フリー誘発
			RETURN 0
		SIF 効果発動済(決闘者,場所,ゾーン)
			RETURN 0
		SIF モンスター数(対面者) < 1 && 魔罠数(対面者) < 1
			RETURN 0
		SIF GETVAR(@"%決闘者%_除外NG置換") >= 1
			RETURN 0
		RETURN 1

	ELSEIF ターンプレイヤー != 決闘者
		SIF ゾーン != "戦場"
			RETURN 0
		SIF モンスター数(決闘者) >= 4
			RETURN 0
		CALL FULLRESET
		効果範囲除外 = 1
		効果条件ID = 52354
		効果条件召喚可 = 1
		CALL CARD_CHECK_ADV(決闘者,種類,ゾーン,場所)
		SIF RESULT != 1
			RETURN 0
		CALL FULLRESET
		効果範囲除外 = 1
		効果条件ID = 52351
		効果条件召喚可 = 1
		CALL CARD_CHECK_ADV(決闘者,種類,ゾーン,場所)
		SIF RESULT != 1
			RETURN 0
		RETURN 1
	ENDIF
	RETURN 0
ENDIF

@CARDEFFECT_52355(決闘者,種類,ゾーン,場所)
#DIMS DYNAMIC 決闘者
#DIMS DYNAMIC ゾーン
#DIM DYNAMIC 種類
#DIM DYNAMIC 場所
#DIM DYNAMIC カウンタ
#DIM DYNAMIC 選択カード
#DIM DYNAMIC 攻撃力修正
#DIM DYNAMIC 除外カードA
#DIM DYNAMIC 除外カードB
#DIMS DYNAMIC 対面者
#DIM DYNAMIC 対戦カード

CALL 対面者判定(決闘者)
対面者 = %RESULTS%

IF 種類 == EXデッキ起動
	CALL CARD_CHOICE(決闘者,種類,ゾーン,場所,52355)
	IF RESULT == 0
		CALL FULLRESET
		効果範囲戦場 = 1
		効果範囲魔罠 = 1
		効果条件行先フラグ = 除外行き
		効果条件ID:0 = 52354
		効果条件ID:1 = 52351
		CALL CARD_ADD_GY_ADV(決闘者,ゾーン,場所)
		IF RESULT == 1
			除外カードA = RESULT:1
			CALL FULLRESET
			効果範囲戦場 = 1
			効果範囲魔罠 = 1
			効果条件行先フラグ = 除外行き
			IF 除外カードA == 52354
				効果条件ID:0 = 52351
			ELSEIF 除外カードA == 52351
				効果条件ID:1 = 52354
			ENDIF
			CALL CARD_ADD_GY_ADV(決闘者,ゾーン,場所)
			IF RESULT == 1
				CALL FULLRESET
				CALL CARD_SP_SUMMON(決闘者,"EXデッキ",場所)	
			ENDIF
		ENDIF
	ENDIF
ELSEIF 種類 == 攻撃時誘発
	CALL CARD_CHOICE(決闘者,種類,ゾーン,場所,52355)
	IF RESULT == 0
		対戦カード = 戦闘場所(決闘者,1)
		CALL FULLRESET
		効果追加種類:0 = 3
		CALL CARD_REMOVAL_BASIC(決闘者,"自動処理",対戦カード,"表示変更")
	ENDIF
ELSEIF 種類 == 戦場起動 || 種類 == フリー誘発
	CALL CARD_CHOICE(決闘者,種類,ゾーン,場所,52355)
	IF RESULT == 0
		IF ターンプレイヤー == 決闘者
			SETVAR @"%決闘者%_MZ_効済:場所", 1
			CALL FULLRESET
			効果条件複数 = 97
			CALL CARD_REMOVAL_BASIC(決闘者,"全場単体",場所,"除外")
		ELSEIF ターンプレイヤー != 決闘者
			CALL CARD_DISPOSE(決闘者,ゾーン,場所,EXデッキ行き)

			CALL FULLRESET
			効果範囲除外 = 1
			効果条件ID = 52354
			CALL CARD_SP_SUMMON_ADV(決闘者,ゾーン,場所)
			SIF モンスター数(決闘者) >= 5
				RETURN 0

			CALL FULLRESET
			効果範囲除外 = 1
			効果条件ID = 52351
			CALL CARD_SP_SUMMON_ADV(決闘者,ゾーン,場所)
		ENDIF
	ENDIF
ENDIF

