@CARDNAME_40077,参照先
;ココで指定卡片の名前、略称を返す予定
#DIMS DYNAMIC 参照先

VARSET RESULT
VARSET RESULTS

SELECTCASE 参照先
	CASE "名前"
		RESULTS = 惑乱魔希特莉丝
	CASE "略称"
		RESULTS = 希特莉丝(惑)
	CASE "カテゴリ"
		RESULTS:0 = 惑乱魔
		RESULTS:1 = E.R.A
ENDSELECT


@CARD_40077(参照先)

#DIMS DYNAMIC 参照先
VARSET RESULT
VARSET RESULTS

SELECTCASE 参照先
	CASE "種類"
		RETURN エクシーズ
	CASE "属性"
		RETURN 地属性
	CASE "種族"
		RETURN 植物族
	CASE "レベル"
		RETURN 4
	CASE "攻撃力"
		RETURN 1250
	CASE "守備力"
		RETURN 1550
	CASE "性別"
		RETURN 牝性
ENDSELECT

RETURN 0

@CARDSUMMON_40077(決闘者,召喚カード,EX参照)
#DIMS DYNAMIC 決闘者
#DIM DYNAMIC 召喚カード
#DIM DYNAMIC EX参照
#DIM DYNAMIC カウンタ

CALL RESETCONDITION_MAT
必要素材数 = 2
素材条件レベル = 4
素材条件カテゴリ:0 = 蟲惑魔
素材条件カテゴリ:1 = 惑乱魔

IF EX参照 == 1
	CALL XYZCAN(決闘者,召喚カード,40077) 
	RETURN RESULT
ENDIF




@CARD_EXPLANATION_40077(種類)
#DIM DYNAMIC 種類

CALL TEXT_DECORATION("ROGUE")
PRINTL レベル4の「蟲惑魔」モンスターまたは「惑乱魔」モンスタx2
PRINTL このカード名の③④⑤の効果はそれぞれ１ターンに１度しか使用できない。
CALLFORM CARD_ABLE(0,永続効果)
PRINTL ①：Ｘ素材を持っているこのカードは罠耐性を持つ。
PRINTL このカードがモンスターゾーンに存在する限り,相手戦場ーは可能であれば毎ターン攻撃する。
CALLFORM CARD_ABLE(0,攻守変動)
PRINTL ②：このカードの攻撃力·守備力上升自分·相手フィールド「蜜罐」的数量*500。
CALLFORM CARD_ABLE(10,戦場起動,フリー誘発)
PRINTL ③：相手ターン中,このカードのＸ素材を１つ取り除いて発動できる。
PRINTL 相手戦場のモンスタ变成攻撃表示,攻撃力为0且「性別を有するモンスター」视为「蜜罐」。
CALLFORM CARD_ABLE(1,攻撃後誘発)
PRINTL ④：对方怪兽在攻击结束后没能让作为攻击对象的「惑乱魔」怪兽离场的场合才能发动。
PRINTL そのカードを破壊する。
PRINTL そのカードが「性別を有するモンスター」した場合,破壊する代わりにそのモンスタ持ち主の魔法＆罠ゾーンに「蜜罐」にして表側表示で置く。
CALLFORM CARD_ABLE(2,ターン終了時)
PRINTL ⑤：自分·相手フィールド有「蜜罐」卡存在,お互いのエンドフェイズに発動できる。
PRINTL このカード得到戦場「蜜罐」的数量的X素材,自己回复戦場「蜜罐」的数量*500的基本分。
CALL TEXT_DECORATION("ROGUE")



@CARDCAN_40077(決闘者,種類,ゾーン,場所)
#DIMS DYNAMIC 決闘者
#DIMS DYNAMIC ゾーン
#DIM DYNAMIC 種類
#DIM DYNAMIC 場所
#DIM DYNAMIC カウンタ
#DIM DYNAMIC 必要的卡
#DIMS DYNAMIC 対面者
#DIM DYNAMIC 条件達成

CALL 対面者判定(決闘者)
対面者 = %RESULTS%

CALL CARD_NEGATE(決闘者,種類,ゾーン,場所,40077)
SIF RESULT == 1
	RETURN 0

IF 種類 == 戦場起動 || 種類 == フリー誘発
	SIF ゾーン != "戦場"
		RETURN 0
	SIF ターンプレイヤー == 決闘者
		RETURN 0
	SIF 発動済_1(決闘者,40077)
		RETURN 0
	SIF GETVAR(@"%決闘者%_MZ_Ｘ:場所") < 0
		RETURN 0

    CALL FULLRESET
	効果範囲相手戦場 = 1
 	CALL CARD_CHECK_ADV(決闘者,種類,ゾーン,場所)
	SIF RESULT != 1
		RETURN 0   
	RETURN 1

ELSEIF 種類 == 攻撃後誘発
	SIF ゾーン != "戦場"
		RETURN 0
	SIF 発動済_2(決闘者,40077)
		RETURN 0
	SIF ターンプレイヤー == 決闘者
		RETURN 0
        
  	CALL FULLRESET
	効果条件カテゴリ = 惑乱魔
	CALL CARD_CHECK_FIN_DATA(決闘者,"戦場離れ")
	SIF RESULT == 1
		RETURN 0      
	RETURN 1

ELSEIF 種類 == ターン終了時
    SIF ゾーン != "戦場"
		RETURN 0
	SIF 発動済_3(決闘者,40077)
		RETURN 0   

  	CALL FULLRESET
	効果範囲戦場 = 1
	効果範囲魔罠 = 1
    効果範囲相手戦場 = 1  
	効果範囲相手魔罠 = 1
	効果条件カテゴリ = 蜜罐
	CALL CARD_CHECK_ADV(決闘者,種類,ゾーン,場所)
	SIF RESULT != 1
		RETURN 0
	RETURN 1    

ELSEIF 種類 == 永続効果 || 種類 == 攻守変動 || 種類 == リアクション効果
	SIF ゾーン != "戦場"
		RETURN 0
	RETURN 1 
ENDIF


@CARDEFFECT_40077(決闘者,種類,ゾーン,場所)
#DIMS DYNAMIC 決闘者
#DIMS DYNAMIC ゾーン
#DIM DYNAMIC 種類
#DIM DYNAMIC 場所
#DIM DYNAMIC カウンタ
#DIM DYNAMIC 守備力修正
#DIM DYNAMIC X消費
#DIM DYNAMIC X素材数
#DIMS DYNAMIC 対面者
#DIM DYNAMIC 選択カード
#DIM DYNAMIC 蜜罐
#DIM DYNAMIC 蜜罐数量
#DIM DYNAMIC 回复量
#DIM DYNAMIC 調教対象


CALL 対面者判定(決闘者)
対面者 = %RESULTS%

IF 種類 == 戦場起動 || 種類 == フリー誘発
	CALL CARD_CHOICE(決闘者,種類,ゾーン,場所,40077,1,X消費1)
	IF RESULT == 0		
		FOR カウンタ,0,5
			SIF GETVAR(@"%対面者%_戦場:カウンタ") == -1
				CONTINUE
			SIF GETVAR(@"%対面者%_MZ_表:カウンタ") == 3
				CONTINUE

			IF GETVAR(@"%対面者%_MZ_攻:カウンタ") <= 0 && GETVAR(@"%対面者%_MZ_性:カウンタ") == 牝性 || GETVAR(@"%対面者%_MZ_性:カウンタ") == ふたなり || GETVAR(@"%対面者%_MZ_性:カウンタ") == 雄性
				CALL CARD_SET_CATEGORY(対面者,"戦場",カウンタ,"蜜罐")
			ENDIF

			CALL CARD_LOADUP

			CALL STATCHANGE_EFFECT(決闘者,"相手戦場",カウンタ,"表",1)
		NEXT
    ENDIF

ELSEIF 種類 == 攻撃後誘発
	CALL CARD_CHOICE(決闘者,種類,ゾーン,場所,40077,2)
	IF RESULT == 0
		選択カード = 戦闘場所(決闘者,1)
		TRYCALLFORM CARD_{戦闘カードID(決闘者,1)}("性別")
		IF RESULT == 牝性 || RESULT == ふたなり || RESULT == 雄性
			TRYCALLFORM CARDNAME_{GETVAR(@"%対面者%_戦場:選択カード")}("名前")
			調教対象 = GETVAR(@"%対面者%_戦場:選択カード")
			CALL FULLRESET
			効果追加カテ = 蜜罐
			CALL CARD_ADD(対面者,"戦場","魔罠",選択カード,"表側表示")

			CALL CARD_EROTICS(調教対象)
			IF RESULT != -1
				調教対象 = RESULT
				SETCOLOR C_PINK
				PRINTFORML
				PRINTFORMW 无力挣脱束缚的%CALLNAME:調教対象%被希特莉丝改造成了生产"花蜜"的蜜罐……！
				PRINTFORML
				RESETCOLOR
				CALL EROTIC_MOVE("苗床捕縛",調教対象, -1)
			ENDIF
		ELSE
			CALL FULLRESET
			CALL CARD_REMOVAL_BASIC(決闘者,"自動処理",選択カード,"墓地")
		ENDIF
	ENDIF

ELSEIF 種類 == ターン終了時
	CALL CARD_CHOICE(決闘者,種類,ゾーン,場所,40077,3)
	IF RESULT == 0
		CALL FULLRESET
		効果範囲戦場 = 1
		効果範囲魔罠 = 1
		効果範囲相手戦場 = 1
		効果範囲相手魔罠 = 1
		効果条件カテゴリ = 蜜罐
		効果条件CNT = 1
		CALL CARD_CHECK_ADV(決闘者,種類,ゾーン,場所)
		蜜罐数量 = RESULT
		回复量 = RESULT * 500
		CALL SET_FIELD_INFO(決闘者,"戦場",場所,"Ｘ",蜜罐数量)
		CALL LIFE_CHANGE(決闘者,"増加","効果",回复量)
	ENDIF

ELSEIF 種類 == 攻守変動
	CALL FULLRESET
	効果範囲戦場 = 1
	効果範囲魔罠 = 1
	効果範囲相手戦場 = 1
	効果範囲相手魔罠 = 1
	効果条件カテゴリ = 蜜罐
	効果条件CNT = 1
	CALL CARD_CHECK_ADV(決闘者,種類,ゾーン,場所)
	蜜罐数量 = RESULT
	守備力修正 = RESULT * 500
	CALL STATCHANGE_BASIC(決闘者,"自身",場所,守備力修正,守備力修正)

ELSEIF 種類 == 永続効果
	CALL FULLRESET
	CALL STATCHANGE_EFFECT(決闘者,"相手戦場",場所,"戦狂")
	IF GETVAR(@"%決闘者%_MZ_Ｘ:場所") >= 1
		CALL FULLRESET
		CALL STATCHANGE_EFFECT(決闘者,"自身",場所,"罠耐")
	ENDIF

ELSEIF 種類 == リアクション効果
	FOR カウンタ,0,5
		SIF GETVAR(@"%決闘者%_魔罠:カウンタ") == -1
			CONTINUE
		SIF GETVAR(@"%決闘者%_魔_リ数:カウンタ") >= 10
			CONTINUE
		TRYCALLFORM CARDNAME_{GETVAR(@"%決闘者%_魔罠:カウンタ")}, "カテゴリ"
		SIF !MATCH(RESULTS, "蜜罐")
			CONTINUE
			
		CALL CARD_EROTICS(GETVAR(@"%決闘者%_魔罠:カウンタ"))
		IF RESULT != -1
			調教対象 = RESULT
			SETCOLOR C_PINK
			PRINTFORML
			PRINTFORMW "花蜜"不受控制的从%CALLNAME:調教対象%的腿上流淌下来……
			PRINTFORML
			RESETCOLOR
			CALL EROTIC_MOVE("拘束晒し",調教対象,-1)
			CALL SET_FIELD_INFO(決闘者,"魔罠",カウンタ,"リ数",1)
		ENDIF
	NEXT

	FOR カウンタ,0,5
		SIF GETVAR(@"%対面者%_魔罠:カウンタ") == -1
			CONTINUE
		SIF GETVAR(@"%対面者%_魔_リ数:カウンタ") >= 10
			CONTINUE
		TRYCALLFORM CARDNAME_{GETVAR(@"%対面者%_魔罠:カウンタ")}, "カテゴリ"
		SIF !MATCH(RESULTS, "蜜罐")
			CONTINUE

		CALL CARD_EROTICS(GETVAR(@"%対面者%_魔罠:カウンタ"))
		IF RESULT != -1
			調教対象 = RESULT
			SETCOLOR C_PINK
			PRINTFORML
			PRINTFORMW "花蜜"不受控制的从%CALLNAME:調教対象%的腿上流淌下来……
			PRINTFORML
			RESETCOLOR
			CALL EROTIC_MOVE("拘束晒し",調教対象,-1)
			CALL SET_FIELD_INFO(対面者,"魔罠",カウンタ,"リ数",1)
		ENDIF
	NEXT
ENDIF